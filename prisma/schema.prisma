// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  uuid         String      @id @default(uuid())
  username     String
  password     String
  email        String      @unique
  business     Business?   @relation(fields: [businessUuid], references: [uuid])
  activation   Activation?
  businessUuid String?
}

model Activation {
  uuid     String @id @default(uuid())
  user     User   @relation(fields: [userUuid], references: [uuid])
  userUuid String
}

model Session {
  sessionId      Int      @id @default(autoincrement())
  token          String   @default(uuid())
  expirationDate DateTime
  creationDate   DateTime @default(now())
}

model Business {
  uuid               String              @id @default(uuid())
  name               String
  address            String
  location           String
  activated          Boolean
  owner              User[]
  devices            Device[]
  businessStatistics BusinessStatistic[]
}

model Device {
  uuid         String   @id @default(uuid())
  macAddress   String
  localAddress String
  cameras      Camera[]
  business     Business @relation(fields: [businessUuid], references: [uuid])
  businessUuid String
}

model Camera {
  uuid            String           @id @default(uuid())
  deviceUuid      String?
  Device          Device?          @relation(fields: [deviceUuid], references: [uuid])
  frameStatistics FrameStatistic[]
}

// Statistics from here
model FrameStatistic {
  uuid             String   @id @default(uuid())
  personalAnalysis Json[]
  masked           Int
  unmasked         Int
  semimasked       Int
  creationDate     DateTime @default(now())
  Camera           Camera?  @relation(fields: [cameraUuid], references: [uuid])
  cameraUuid       String?
}

model CameraStatistcs {
  uuid         String    @id @default(uuid())
  
}

model BusinessStatistic {
  uuid         String    @id @default(uuid())
  Business     Business? @relation(fields: [businessUuid], references: [uuid])
  businessUuid String?
}
